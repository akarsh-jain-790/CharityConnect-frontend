{"ast":null,"code":"import _defineProperty from\"/Users/akarshjain/Desktop/bookoe/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _regeneratorRuntime from\"/Users/akarshjain/Desktop/bookoe/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/akarshjain/Desktop/bookoe/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var _extraReducers;import{createAsyncThunk,createSlice}from\"@reduxjs/toolkit\";var baseUrl=\"http://localhost:4000/api/v1\";export var authenticateUser2=createAsyncThunk(\"users/authenticate\",/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(user){var response,json;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"\".concat(baseUrl,\"/accounts/login\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(user)});case 2:response=_context.sent;_context.next=5;return response.json();case 5:json=_context.sent;if(!response.ok){_context.next=11;break;}localStorage.setItem(\"Authentication-token\",json.token);return _context.abrupt(\"return\",json);case 11:throw new Error(json.message);case 12:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());export var logoutUser=createAsyncThunk(\"users/logout\",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:localStorage.removeItem('Authentication-token');return _context2.abrupt(\"return\",\"logged out\");case 2:case\"end\":return _context2.stop();}}},_callee2);})));export var userSlice=createSlice({name:\"authentication\",initialState:{user:{_id:\"\",first_name:\"\",username:\"\",last_name:\"\",email:\"\",role:\"\"},token:\"\",pending:false,error:false,error_message:''},reducers:{},extraReducers:(_extraReducers={},_defineProperty(_extraReducers,authenticateUser2.pending,function(state){state.pending=true;}),_defineProperty(_extraReducers,authenticateUser2.fulfilled,function(state,action){state.pending=false;state.user=action.payload.userData;state.token=action.payload.token;}),_defineProperty(_extraReducers,authenticateUser2.rejected,function(state,action){state.pending=false;state.error=true;state.error_message=action.error.message;}),_defineProperty(_extraReducers,logoutUser.fulfilled,function(state,action){state.user=null;}),_defineProperty(_extraReducers,logoutUser.rejected,function(state,action){state.error=true;state.error_message=action.error.message;}),_extraReducers)});export default userSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","baseUrl","authenticateUser2","user","fetch","method","headers","body","JSON","stringify","response","json","ok","localStorage","setItem","token","Error","message","logoutUser","removeItem","userSlice","name","initialState","_id","first_name","username","last_name","email","role","pending","error","error_message","reducers","extraReducers","state","fulfilled","action","payload","userData","rejected","reducer"],"sources":["/Users/akarshjain/Desktop/bookoe/src/redux/Slices/authenticationSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\n\nconst baseUrl = `http://localhost:4000/api/v1`;\n\nexport const authenticateUser2 = createAsyncThunk(\n  \"users/authenticate\",\n  async (user) => {\n      const response = await fetch(`${baseUrl}/accounts/login`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(user),\n      });\n\n    const json = await response.json(); \n    if(response.ok){\n        localStorage.setItem(\"Authentication-token\", json.token);\n        return json;\n    }\n    else{\n        throw new Error(json.message);\n    }\n  }\n);\n\nexport const logoutUser = createAsyncThunk(\n    \"users/logout\",\n    async () => {\n        localStorage.removeItem('Authentication-token');\n        return \"logged out\"\n    }\n  );\n\nexport const userSlice = createSlice({\n  name: \"authentication\",\n  initialState: {\n    user: {\n      _id: \"\",\n      first_name: \"\",\n      username: \"\",\n      last_name: \"\",\n      email: \"\",\n      role: \"\",\n    },\n    token: \"\",\n    pending: false,\n    error: false,\n    error_message: ''\n  },\n  reducers: {},\n  extraReducers: {\n    [authenticateUser2.pending]: (state) => {\n      state.pending = true;\n    },\n    [authenticateUser2.fulfilled]: (state, action) => {\n      state.pending = false;\n      state.user = action.payload.userData;\n      state.token = action.payload.token;\n    },\n    [authenticateUser2.rejected]: (state, action) => {\n      state.pending = false;\n      state.error = true;\n      state.error_message = action.error.message;\n    },\n\n    [logoutUser.fulfilled]: (state, action) => {\n        state.user = null;\n    },\n    [logoutUser.rejected]: (state, action) => {\n        state.error = true;\n        state.error_message = action.error.message;\n    },\n  },\n});\n\nexport default userSlice.reducer;\n"],"mappings":"uYAAA,OAASA,gBAAT,CAA2BC,WAA3B,KAA8C,kBAA9C,CAEA,GAAMC,QAAO,+BAAb,CAEA,MAAO,IAAMC,kBAAiB,CAAGH,gBAAgB,CAC/C,oBAD+C,4FAE/C,iBAAOI,IAAP,4JAC2BC,MAAK,WAAIH,OAAJ,oBAA8B,CACxDI,MAAM,CAAE,MADgD,CAExDC,OAAO,CAAE,CACP,eAAgB,kBADT,CAF+C,CAKxDC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeN,IAAf,CALkD,CAA9B,CADhC,QACUO,QADV,qCASqBA,SAAQ,CAACC,IAAT,EATrB,QASQA,IATR,mBAUKD,QAAQ,CAACE,EAVd,0BAWMC,YAAY,CAACC,OAAb,CAAqB,sBAArB,CAA6CH,IAAI,CAACI,KAAlD,EAXN,gCAYaJ,IAZb,eAeY,IAAIK,MAAJ,CAAUL,IAAI,CAACM,OAAf,CAfZ,wDAF+C,+DAA1C,CAsBP,MAAO,IAAMC,WAAU,CAAGnB,gBAAgB,CACtC,cADsC,wEAEtC,0IACIc,YAAY,CAACM,UAAb,CAAwB,sBAAxB,EADJ,iCAEW,YAFX,0DAFsC,GAAnC,CAQP,MAAO,IAAMC,UAAS,CAAGpB,WAAW,CAAC,CACnCqB,IAAI,CAAE,gBAD6B,CAEnCC,YAAY,CAAE,CACZnB,IAAI,CAAE,CACJoB,GAAG,CAAE,EADD,CAEJC,UAAU,CAAE,EAFR,CAGJC,QAAQ,CAAE,EAHN,CAIJC,SAAS,CAAE,EAJP,CAKJC,KAAK,CAAE,EALH,CAMJC,IAAI,CAAE,EANF,CADM,CASZb,KAAK,CAAE,EATK,CAUZc,OAAO,CAAE,KAVG,CAWZC,KAAK,CAAE,KAXK,CAYZC,aAAa,CAAE,EAZH,CAFqB,CAgBnCC,QAAQ,CAAE,EAhByB,CAiBnCC,aAAa,mDACV/B,iBAAiB,CAAC2B,OADR,CACkB,SAACK,KAAD,CAAW,CACtCA,KAAK,CAACL,OAAN,CAAgB,IAAhB,CACD,CAHU,iCAIV3B,iBAAiB,CAACiC,SAJR,CAIoB,SAACD,KAAD,CAAQE,MAAR,CAAmB,CAChDF,KAAK,CAACL,OAAN,CAAgB,KAAhB,CACAK,KAAK,CAAC/B,IAAN,CAAaiC,MAAM,CAACC,OAAP,CAAeC,QAA5B,CACAJ,KAAK,CAACnB,KAAN,CAAcqB,MAAM,CAACC,OAAP,CAAetB,KAA7B,CACD,CARU,iCASVb,iBAAiB,CAACqC,QATR,CASmB,SAACL,KAAD,CAAQE,MAAR,CAAmB,CAC/CF,KAAK,CAACL,OAAN,CAAgB,KAAhB,CACAK,KAAK,CAACJ,KAAN,CAAc,IAAd,CACAI,KAAK,CAACH,aAAN,CAAsBK,MAAM,CAACN,KAAP,CAAab,OAAnC,CACD,CAbU,iCAeVC,UAAU,CAACiB,SAfD,CAea,SAACD,KAAD,CAAQE,MAAR,CAAmB,CACvCF,KAAK,CAAC/B,IAAN,CAAa,IAAb,CACH,CAjBU,iCAkBVe,UAAU,CAACqB,QAlBD,CAkBY,SAACL,KAAD,CAAQE,MAAR,CAAmB,CACtCF,KAAK,CAACJ,KAAN,CAAc,IAAd,CACAI,KAAK,CAACH,aAAN,CAAsBK,MAAM,CAACN,KAAP,CAAab,OAAnC,CACH,CArBU,iBAjBsB,CAAD,CAA7B,CA0CP,cAAeG,UAAS,CAACoB,OAAzB"},"metadata":{},"sourceType":"module"}