{"ast":null,"code":"import _defineProperty from\"/Volumes/T7/IT_Days/ngo-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _regeneratorRuntime from\"/Volumes/T7/IT_Days/ngo-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Volumes/T7/IT_Days/ngo-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var _extraReducers;import{createAsyncThunk,createSlice}from\"@reduxjs/toolkit\";var baseUrl=\"http://localhost:4000/api/v1\";/**\n  * @asyncThunk Login function\n  * @desc manage the user state when user log-in\n  * @param  string $user - user state\n  * @return returns user data in case of success and in case of error return error message.\n*/export var authenticateUser=createAsyncThunk(\"users/authenticate\",/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(user){var response,json;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"\".concat(baseUrl,\"/accounts/login\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(user)});case 2:response=_context.sent;_context.next=5;return response.json();case 5:json=_context.sent;if(!response.ok){_context.next=11;break;}localStorage.setItem(\"Authentication-token\",json.token);return _context.abrupt(\"return\",json);case 11:throw new Error(json.message);case 12:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());/**\n  * @asyncThunk Login function\n  * @desc manage the user state when user log-in\n  * @param  string $user - user state\n  * @return returns user data in case of success and in case of error return error message.\n*/export var registerUser=createAsyncThunk(\"users/register\",/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(user){var response,json;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(\"\".concat(baseUrl,\"/accounts/register\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(user)});case 2:response=_context2.sent;_context2.next=5;return response.json();case 5:json=_context2.sent;if(!response.ok){_context2.next=10;break;}return _context2.abrupt(\"return\",json);case 10:throw new Error(json.message);case 11:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}());/**\n  * @asyncThunk Logout function\n  * @desc log-out user and make the state empty if successfull\n  * @return Redirect to home page insted and show alert message in case of success and error both\n*/export var logoutUser=createAsyncThunk(\"users/logout\",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:localStorage.removeItem('Authentication-token');// TODO: Redirect to home page insted and show alert message in case of success and error both.\nreturn _context3.abrupt(\"return\",\"logged out\");case 2:case\"end\":return _context3.stop();}}},_callee3);})));export var userSlice=createSlice({name:\"authentication\",initialState:{user:{_id:\"\",first_name:\"\",username:\"\",last_name:\"\",email:\"\",role:\"\"},token:\"\",pending:false,success_message:'',error:false,error_message:''},reducers:{},extraReducers:(_extraReducers={},_defineProperty(_extraReducers,authenticateUser.pending,function(state){state.pending=true;}),_defineProperty(_extraReducers,authenticateUser.fulfilled,function(state,action){state.pending=false;state.user=action.payload.userData;state.token=action.payload.token;}),_defineProperty(_extraReducers,authenticateUser.rejected,function(state,action){state.pending=false;state.error=true;state.error_message=action.error.message;}),_defineProperty(_extraReducers,registerUser.pending,function(state){state.pending=true;}),_defineProperty(_extraReducers,registerUser.fulfilled,function(state,action){state.pending=false;state.error=false;state.success_message=action.payload.message;}),_defineProperty(_extraReducers,registerUser.rejected,function(state,action){state.pending=false;state.error=true;state.error_message=action.error.message;}),_defineProperty(_extraReducers,logoutUser.fulfilled,function(state,action){state.user=null;}),_defineProperty(_extraReducers,logoutUser.rejected,function(state,action){state.error=true;state.error_message=action.error.message;}),_extraReducers)});export default userSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","baseUrl","authenticateUser","user","fetch","method","headers","body","JSON","stringify","response","json","ok","localStorage","setItem","token","Error","message","registerUser","logoutUser","removeItem","userSlice","name","initialState","_id","first_name","username","last_name","email","role","pending","success_message","error","error_message","reducers","extraReducers","state","fulfilled","action","payload","userData","rejected","reducer"],"sources":["/Volumes/T7/IT_Days/ngo-frontend/src/redux/Slices/authenticationSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\n\nconst baseUrl = `http://localhost:4000/api/v1`;\n\n/**\n  * @asyncThunk Login function\n  * @desc manage the user state when user log-in\n  * @param  string $user - user state\n  * @return returns user data in case of success and in case of error return error message.\n*/\nexport const authenticateUser = createAsyncThunk(\n  \"users/authenticate\",\n  async (user) => {\n      const response = await fetch(`${baseUrl}/accounts/login`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(user),\n      });\n\n    const json = await response.json(); \n    if(response.ok){\n        localStorage.setItem(\"Authentication-token\", json.token);\n        return json;\n    }\n    else{\n        throw new Error(json.message);\n    }\n  }\n);\n\n\n/**\n  * @asyncThunk Login function\n  * @desc manage the user state when user log-in\n  * @param  string $user - user state\n  * @return returns user data in case of success and in case of error return error message.\n*/\nexport const registerUser = createAsyncThunk(\n    \"users/register\",\n    async (user) => {\n        const response = await fetch(`${baseUrl}/accounts/register`, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify(user),\n        });\n  \n      const json = await response.json();\n      if(response.ok){\n          return json;\n      }\n      else{\n          throw new Error(json.message);\n      }\n    }\n  );\n\n/**\n  * @asyncThunk Logout function\n  * @desc log-out user and make the state empty if successfull\n  * @return Redirect to home page insted and show alert message in case of success and error both\n*/\nexport const logoutUser = createAsyncThunk(\n    \"users/logout\",\n    async () => {\n        localStorage.removeItem('Authentication-token');\n        // TODO: Redirect to home page insted and show alert message in case of success and error both.\n        return \"logged out\"\n    }\n  );\n\n  export const userSlice = createSlice({\n    name: \"authentication\",\n    initialState: {\n      user: {\n        _id: \"\",\n        first_name: \"\",\n        username: \"\",\n        last_name: \"\",\n        email: \"\",\n        role: \"\",\n      },\n      token: \"\",\n      pending: false,\n      success_message: '',\n      error: false,\n      error_message: ''\n    },\n    reducers: {},\n    extraReducers: {\n        //? States for authentication.\n        [authenticateUser.pending]: (state) => {\n            state.pending = true;\n        },\n        [authenticateUser.fulfilled]: (state, action) => {\n            state.pending = false;\n            state.user = action.payload.userData;\n            state.token = action.payload.token;\n        },\n        [authenticateUser.rejected]: (state, action) => {\n            state.pending = false;\n            state.error = true;\n            state.error_message = action.error.message;\n        },\n        //? States for registration.\n        [registerUser.pending]: (state) => {\n            state.pending = true;\n        },\n        [registerUser.fulfilled]: (state, action) => {\n            state.pending = false;\n            state.error = false;\n            state.success_message = action.payload.message;\n        },\n        [registerUser.rejected]: (state, action) => {\n            state.pending = false;\n            state.error = true;\n            state.error_message = action.error.message;\n        },\n        //? States for logout.\n        [logoutUser.fulfilled]: (state, action) => {\n            state.user = null;\n        },\n        [logoutUser.rejected]: (state, action) => {\n            state.error = true;\n            state.error_message = action.error.message;\n        },\n    },\n  });\n\n\nexport default userSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}