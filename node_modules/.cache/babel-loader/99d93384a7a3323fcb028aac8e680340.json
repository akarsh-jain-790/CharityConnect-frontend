{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nconst baseUrl = `http://localhost:4000/api/v1`;\nexport const authenticateUser2 = createAsyncThunk(\"users/authenticate\", async user => {\n  const response = await fetch(`${baseUrl}/accounts/login`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(user)\n  });\n  const json = await response.json();\n\n  if (response.ok) {\n    localStorage.setItem(\"Authentication-token\", json.token);\n    return json;\n  } else {\n    throw new Error(json.message);\n  }\n});\nexport const logoutUser = createAsyncThunk(\"users/logout\", async () => {\n  localStorage.removeItem('Authentication-token'); // TODO: Redirect to home page insted and show alert message.\n\n  return \"logged out\";\n});\nexport const userSlice = createSlice({\n  name: \"authentication\",\n  initialState: {\n    user: {\n      _id: \"\",\n      first_name: \"\",\n      username: \"\",\n      last_name: \"\",\n      email: \"\",\n      role: \"\"\n    },\n    token: \"\",\n    pending: false,\n    error: false,\n    error_message: ''\n  },\n  reducers: {},\n  extraReducers: {\n    [authenticateUser2.pending]: state => {\n      state.pending = true;\n    },\n    [authenticateUser2.fulfilled]: (state, action) => {\n      state.pending = false;\n      state.user = action.payload.userData;\n      state.token = action.payload.token;\n    },\n    [authenticateUser2.rejected]: (state, action) => {\n      state.pending = false;\n      state.error = true;\n      state.error_message = action.error.message;\n    },\n    [logoutUser.fulfilled]: (state, action) => {\n      state.user = null;\n    },\n    [logoutUser.rejected]: (state, action) => {\n      state.error = true;\n      state.error_message = action.error.message;\n    }\n  }\n});\nexport default userSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","baseUrl","authenticateUser2","user","response","fetch","method","headers","body","JSON","stringify","json","ok","localStorage","setItem","token","Error","message","logoutUser","removeItem","userSlice","name","initialState","_id","first_name","username","last_name","email","role","pending","error","error_message","reducers","extraReducers","state","fulfilled","action","payload","userData","rejected","reducer"],"sources":["/Users/akarshjain/Desktop/bookoe/src/redux/Slices/authenticationSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\n\nconst baseUrl = `http://localhost:4000/api/v1`;\n\nexport const authenticateUser2 = createAsyncThunk(\n  \"users/authenticate\",\n  async (user) => {\n      const response = await fetch(`${baseUrl}/accounts/login`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(user),\n      });\n\n    const json = await response.json(); \n    if(response.ok){\n        localStorage.setItem(\"Authentication-token\", json.token);\n        return json;\n    }\n    else{\n        throw new Error(json.message);\n    }\n  }\n);\n\nexport const logoutUser = createAsyncThunk(\n    \"users/logout\",\n    async () => {\n        localStorage.removeItem('Authentication-token');\n        // TODO: Redirect to home page insted and show alert message.\n        return \"logged out\"\n    }\n  );\n\nexport const userSlice = createSlice({\n  name: \"authentication\",\n  initialState: {\n    user: {\n      _id: \"\",\n      first_name: \"\",\n      username: \"\",\n      last_name: \"\",\n      email: \"\",\n      role: \"\",\n    },\n    token: \"\",\n    pending: false,\n    error: false,\n    error_message: ''\n  },\n  reducers: {},\n  extraReducers: {\n    [authenticateUser2.pending]: (state) => {\n      state.pending = true;\n    },\n    [authenticateUser2.fulfilled]: (state, action) => {\n      state.pending = false;\n      state.user = action.payload.userData;\n      state.token = action.payload.token;\n    },\n    [authenticateUser2.rejected]: (state, action) => {\n      state.pending = false;\n      state.error = true;\n      state.error_message = action.error.message;\n    },\n\n    [logoutUser.fulfilled]: (state, action) => {\n        state.user = null;\n    },\n    [logoutUser.rejected]: (state, action) => {\n        state.error = true;\n        state.error_message = action.error.message;\n    },\n  },\n});\n\nexport default userSlice.reducer;\n"],"mappings":"AAAA,SAASA,gBAAT,EAA2BC,WAA3B,QAA8C,kBAA9C;AAEA,MAAMC,OAAO,GAAI,8BAAjB;AAEA,OAAO,MAAMC,iBAAiB,GAAGH,gBAAgB,CAC/C,oBAD+C,EAE/C,MAAOI,IAAP,IAAgB;EACZ,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAE,GAAEJ,OAAQ,iBAAZ,EAA8B;IACxDK,MAAM,EAAE,MADgD;IAExDC,OAAO,EAAE;MACP,gBAAgB;IADT,CAF+C;IAKxDC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeP,IAAf;EALkD,CAA9B,CAA5B;EAQF,MAAMQ,IAAI,GAAG,MAAMP,QAAQ,CAACO,IAAT,EAAnB;;EACA,IAAGP,QAAQ,CAACQ,EAAZ,EAAe;IACXC,YAAY,CAACC,OAAb,CAAqB,sBAArB,EAA6CH,IAAI,CAACI,KAAlD;IACA,OAAOJ,IAAP;EACH,CAHD,MAII;IACA,MAAM,IAAIK,KAAJ,CAAUL,IAAI,CAACM,OAAf,CAAN;EACH;AACF,CAnB8C,CAA1C;AAsBP,OAAO,MAAMC,UAAU,GAAGnB,gBAAgB,CACtC,cADsC,EAEtC,YAAY;EACRc,YAAY,CAACM,UAAb,CAAwB,sBAAxB,EADQ,CAER;;EACA,OAAO,YAAP;AACH,CANqC,CAAnC;AASP,OAAO,MAAMC,SAAS,GAAGpB,WAAW,CAAC;EACnCqB,IAAI,EAAE,gBAD6B;EAEnCC,YAAY,EAAE;IACZnB,IAAI,EAAE;MACJoB,GAAG,EAAE,EADD;MAEJC,UAAU,EAAE,EAFR;MAGJC,QAAQ,EAAE,EAHN;MAIJC,SAAS,EAAE,EAJP;MAKJC,KAAK,EAAE,EALH;MAMJC,IAAI,EAAE;IANF,CADM;IASZb,KAAK,EAAE,EATK;IAUZc,OAAO,EAAE,KAVG;IAWZC,KAAK,EAAE,KAXK;IAYZC,aAAa,EAAE;EAZH,CAFqB;EAgBnCC,QAAQ,EAAE,EAhByB;EAiBnCC,aAAa,EAAE;IACb,CAAC/B,iBAAiB,CAAC2B,OAAnB,GAA8BK,KAAD,IAAW;MACtCA,KAAK,CAACL,OAAN,GAAgB,IAAhB;IACD,CAHY;IAIb,CAAC3B,iBAAiB,CAACiC,SAAnB,GAA+B,CAACD,KAAD,EAAQE,MAAR,KAAmB;MAChDF,KAAK,CAACL,OAAN,GAAgB,KAAhB;MACAK,KAAK,CAAC/B,IAAN,GAAaiC,MAAM,CAACC,OAAP,CAAeC,QAA5B;MACAJ,KAAK,CAACnB,KAAN,GAAcqB,MAAM,CAACC,OAAP,CAAetB,KAA7B;IACD,CARY;IASb,CAACb,iBAAiB,CAACqC,QAAnB,GAA8B,CAACL,KAAD,EAAQE,MAAR,KAAmB;MAC/CF,KAAK,CAACL,OAAN,GAAgB,KAAhB;MACAK,KAAK,CAACJ,KAAN,GAAc,IAAd;MACAI,KAAK,CAACH,aAAN,GAAsBK,MAAM,CAACN,KAAP,CAAab,OAAnC;IACD,CAbY;IAeb,CAACC,UAAU,CAACiB,SAAZ,GAAwB,CAACD,KAAD,EAAQE,MAAR,KAAmB;MACvCF,KAAK,CAAC/B,IAAN,GAAa,IAAb;IACH,CAjBY;IAkBb,CAACe,UAAU,CAACqB,QAAZ,GAAuB,CAACL,KAAD,EAAQE,MAAR,KAAmB;MACtCF,KAAK,CAACJ,KAAN,GAAc,IAAd;MACAI,KAAK,CAACH,aAAN,GAAsBK,MAAM,CAACN,KAAP,CAAab,OAAnC;IACH;EArBY;AAjBoB,CAAD,CAA7B;AA0CP,eAAeG,SAAS,CAACoB,OAAzB"},"metadata":{},"sourceType":"module"}